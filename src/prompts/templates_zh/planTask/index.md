## 任务分析

你必须依序完成以下子步骤，并在最后调用 `analyze_task` 工具，将初步设计方案传递给下一阶段。

1. **分析目的**

   - 读取并理解：
     ```
     任务说明：{description}
     任务要求与限制：{requirements}
     {tasksTemplate}
     ```
   - 确认：
     - 任务目标与预期成果
     - 技术挑战与关键决策点
     - 与现有系统／架构的集成需求

2. **识别项目架构**

   - 查看关键配置文档与结构：
     - 查看根目录结构和重要配置文档（package.json, tsconfig.json 等）
     - 如果 shrimp-rules.md 存在请详细阅读并参考
     - 分析主要的目录组织和模块划分
   - 辨识架构模式：
     - 识别内核设计模式和架构风格（MVC, MVVM, 微服务等）
     - 确定项目的分层结构和模块边界
   - 分析内核组件：
     - 研究主要类别/接口设计与依赖关系
     - 标记关键服务/工具类及其职责和用途
   - 记录既有模式：
     - 记录发现的代码组织方式和架构规律
     - 创建对项目技术栈和架构特性的深入理解

3. **收集信息**  
   如有任何不确定或信心不足，**必做其一**：

   - 向用户提问以厘清
   - 使用 `query_task`、`read_file`、`codebase_search`或其他类似的工具查找现有进程／架构
   - 使用 `web_search` 或其他网络搜索工具查找不熟悉的概念或技术  
     禁止凭空臆测，所有信息必可追溯来源。

4. **检查现有进程与结构**

   - 使用精确的搜索策略：
     - 利用 `read_file`、`codebase_search`或其他类似的工具查找与任务相关的现有实现方式
     - 寻找与当前任务功能类似的现有代码
     - 分析目录结构寻找相似功能模块
   - 分析代码风格与约定：
     - 检查现有组件的命名规则（驼峰式、蛇形等）
     - 确认注释风格和格式约定
     - 分析错误处理模式和日志记录方式
   - 记录并遵循发现的模式：
     - 详细记录代码模式和组织结构
     - 计划如何沿用这些模式进行设计
   - 判断是否与现有功能重叠，并决定「重用」或「抽象重构」
   - **不得**先生成设计再查现有码；必须「先查再设」

5. **任务类型特定指南**

   根据任务特性，额外考虑以下特定指南：

   - **前端/UI 任务**：

     - 优先查看现有 UI 组件库和设计系统
     - 分析页面布局结构和组件组合模式
     - 确认样式管理方式（CSS 模块、Styled Components 等）
     - 理解状态管理和数据流模式

   - **后端 API 任务**：

     - 检查 API 路由结构和命名约定
     - 分析请求处理和中间件模式
     - 确认错误处理和响应格式标准
     - 理解授权/身份验证实现方式

   - **数据库操作**：
     - 分析现有的数据访问模式和抽象层
     - 确认查找构建和事务处理方式
     - 理解关联关系处理和数据验证方法
     - 检查缓存策略和性能优化手段

6. **初步方案产出**
   - 根据上述，撰写「初步设计方案」：
     - 清楚标示 **事实**（来源） vs **推论**（选择依据）
     - 禁止模糊语句，须为最终可交付成果
     - 确保方案与项目既有架构模式一致
     - 说明如何重用现有组件或遵循现有模式
   - 过程必须一步一步思考并梳理思绪，如果问题过于复杂可以利用`process_thought`来思考
   - **严重警告**：禁止一切`假设`与`猜测`与`幻想`，你必须通过一切你`可以使用的工具`来`收集信息`
   - 调用工具：
     ```
     analyze_task({ summary: <任务摘要>, initialConcept: <初步构想> })
     ```

**现在开始调用 `analyze_task`，严禁不调用工具**
